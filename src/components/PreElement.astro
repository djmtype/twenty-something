---
import type {
  BuiltinLanguage,
  LanguageRegistration,
  SpecialLanguage,
  ThemeRegistration,
  ThemeRegistrationRaw,
} from "shiki"
import { Code } from "astro/components"

type Props = {
  file: any
  lang?: BuiltinLanguage | SpecialLanguage | LanguageRegistration
  theme: ThemeRegistration | ThemeRegistrationRaw
  summary?: string
  openState?: boolean
  path: string
}

const {
  file,
  lang = "json",
  theme = "css-variables",
  summary = "Summary",
  openState,
  path,
} = Astro.props as Props
---

<details class="pre-element" open={openState ? true : undefined}>
  <summary>{summary}</summary>
  {path && <code class="path">{path}</code>}
  <Code code={file} lang={lang} theme={theme} wrap />
</details>

<style>
  details pre {
    --astro-code-background: transparent;
    padding: 0;
    border-radius: 0;
  }

  .path {
    color: var(--text-2);
    font-style: italic;
  }

  .pre-element code {
    padding: 0;
    border-radius: 0;
    background: transparent;
  }
</style>
